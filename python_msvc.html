<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using Microsoft Visual C with Python &#8212; pydagogue 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/traditional.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using pip on Debian / Ubuntu" href="installing_on_debian.html" />
    <link rel="prev" title="Installing python scripts" href="installing_scripts.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="installing_on_debian.html" title="Using pip on Debian / Ubuntu"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installing_scripts.html" title="Installing python scripts"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="python.html" accesskey="U">Notes and tutorials on Python</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-microsoft-visual-c-with-python">
<h1>Using Microsoft Visual C with Python<a class="headerlink" href="#using-microsoft-visual-c-with-python" title="Permalink to this headline">¶</a></h1>
<div class="section" id="visual-studio-compiler-versions">
<h2>Visual studio compiler versions<a class="headerlink" href="#visual-studio-compiler-versions" title="Permalink to this headline">¶</a></h2>
<p>Here is a list of Visual Studio / <a class="reference external" href="http://en.wikipedia.org/wiki/Visual_C%2B%2B">Visual C++</a> version numbers, the value of
the defined <code class="docutils literal"><span class="pre">_MSC_VER</span></code> during compilation, the alternative year-based name,
and the C / C++ runtime library.</p>
<p>For sources on version numbers / <code class="docutils literal"><span class="pre">_MSC_VER</span></code>:</p>
<ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/questions/3592805/detecting-compiler-versions-during-compile-time">a stackoverflow table</a>;</li>
<li>a <a class="reference external" href="http://sourceforge.net/p/predef/wiki/Compilers">sourceforge wiki page on compilers</a>;</li>
<li><a class="reference external" href="http://stackoverflow.com/questions/2676763/what-version-of-visual-studio-is-python-on-my-computer-compiled-with">stackoverflow answer on VC and Python</a>.</li>
</ul>
<p>For VC runtime libraries:</p>
<ul class="simple">
<li>a <a class="reference external" href="https://support.microsoft.com/en-us/kb/154753">list of VS versions / CRTS</a>;</li>
<li>a <a class="reference external" href="http://yuhongbao.blogspot.com/2014/10/the-history-of-ms-c-runtime-dll.html">history of the MS CRTS</a>;</li>
<li>the MS <a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh(v=vs.100).aspx">C runtime library pages</a>;</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="28%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">VC++ version</th>
<th class="head">_MSC_VER</th>
<th class="head">Alternative name</th>
<th class="head">C runtime</th>
<th class="head">C++ runtime</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1.0</td>
<td>800</td>
<td>&nbsp;</td>
<td>MSVCRT10.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>2.0</td>
<td>900</td>
<td>&nbsp;</td>
<td>MSVCRT20.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>4.0</td>
<td>1000</td>
<td>&nbsp;</td>
<td>MSVCRT40.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>4.2</td>
<td>1020</td>
<td>&nbsp;</td>
<td>MSVCRT.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>5.0</td>
<td>1100</td>
<td>Visual Studio 97</td>
<td>MSVCRT.DLL</td>
<td>MSVCP50.DLL</td>
</tr>
<tr class="row-odd"><td>6.0</td>
<td>1200</td>
<td>&nbsp;</td>
<td>MSVCRT.DLL</td>
<td>MSVCP60.DLL</td>
</tr>
<tr class="row-even"><td>7.0</td>
<td>1300</td>
<td>Visual Studio 2002</td>
<td>MSVCR70.DLL</td>
<td>MSVCP70.DLL</td>
</tr>
<tr class="row-odd"><td>7.1</td>
<td>1310</td>
<td>Visual Studio 2003</td>
<td>MSVCR71.DLL</td>
<td>MSVCP71.DLL</td>
</tr>
<tr class="row-even"><td>8.0</td>
<td>1400</td>
<td>Visual Studio 2005</td>
<td>MSVCR80.DLL</td>
<td>MSVCP80.DLL</td>
</tr>
<tr class="row-odd"><td>9.0</td>
<td>1500</td>
<td>Visual Studio 2008</td>
<td>MSVCR90.DLL</td>
<td>MSVCP90.DLL</td>
</tr>
<tr class="row-even"><td>10.0</td>
<td>1600</td>
<td>Visual Studio 2010</td>
<td>MSVCR100.DLL</td>
<td>MSVCP100.DLL</td>
</tr>
<tr class="row-odd"><td>11.0</td>
<td>1700</td>
<td>Visual Studio 2012</td>
<td>MSVCR110.DLL</td>
<td>MSVCP110.DLL</td>
</tr>
<tr class="row-even"><td>12.0</td>
<td>1800</td>
<td>Visual Studio 2013</td>
<td>MSVCR120.DLL</td>
<td>MSVCP120.DLL</td>
</tr>
<tr class="row-odd"><td>14.0</td>
<td>1900</td>
<td>Visual Studio 2015</td>
<td>See notes</td>
<td>MSVCP140.DLL</td>
</tr>
</tbody>
</table>
<p>For a discussion of the generic <code class="docutils literal"><span class="pre">MSVCRT.DLL</span></code> compared to the DLLs specific
to the VC version, see <a class="reference external" href="https://kobyk.wordpress.com/2007/07/20/dynamically-linking-with-msvcrtdll-using-visual-c-2005">this blog post</a>.
See also <a class="reference external" href="http://sourceforge.net/p/mingw-w64/wiki2/The%20case%20against%20msvcrt.dll">these comments on using MSVCRT.DLL from Mingw-w64</a>.</p>
<p>For 2015, MS split the C runtime into two component libraries.  See:</p>
<ul class="simple">
<li>blog post on the <a class="reference external" href="http://blogs.msdn.com/b/vcblog/archive/2015/03/03/introducing-the-universal-crt.aspx">the universal CRT</a></li>
<li>Steve Dower&#8217;s first blog post: <a class="reference external" href="http://stevedower.id.au/blog/building-for-python-3-5">Python 3.5 extensions part 1</a>;</li>
<li>Steve&#8217;s second blog post: <a class="reference external" href="http://stevedower.id.au/blog/building-for-python-3-5-part-two">Python 3.5 extensions part 2</a>;</li>
</ul>
<p>The CRT components are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ucrtbase.dl</span></code>: &#8220;The Universal CRT (UCRT) contains the functions and
globals exported by the standard C99 CRT library. The UCRT is now a Windows
component, and ships as part of Windows 10.&#8221; (see <a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>).</li>
<li><code class="docutils literal"><span class="pre">vcruntime140.dll</span></code> : &#8220;The vcruntime library contains Visual C++ CRT
implementation-specific code, such as exception handling and debugging
support, runtime checks and type information, implementation details and
certain extended library functions. This library is specific to the version
of the compiler used.&#8221; (<a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>);</li>
</ul>
<p>The C++ runtime for VS2015 is <code class="docutils literal"><span class="pre">MSVCP140.dll</span></code> (<a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>).</p>
</div>
<div class="section" id="visual-studio-versions-used-to-compile-distributed-python-binaries">
<h2>Visual Studio versions used to compile distributed Python binaries<a class="headerlink" href="#visual-studio-versions-used-to-compile-distributed-python-binaries" title="Permalink to this headline">¶</a></h2>
<p>See:
<a class="reference external" href="http://stackoverflow.com/questions/12028762/what-version-of-visual-studio-and-or-mingw-do-i-need-to-build-extension-modules">http://stackoverflow.com/questions/12028762/what-version-of-visual-studio-and-or-mingw-do-i-need-to-build-extension-modules</a></p>
<p>and: <a class="reference external" href="http://stackoverflow.com/questions/9047072/windows-python-version-and-vc-redistributable-version">http://stackoverflow.com/questions/9047072/windows-python-version-and-vc-redistributable-version</a></p>
<p>The version of Visual Studio is described in <code class="docutils literal"><span class="pre">readme.txt</span></code> in the <code class="docutils literal"><span class="pre">PCBuild</span></code>
folder of the source distribution.  The full Visual C++ version number is in
either <code class="docutils literal"><span class="pre">release.vsprops</span></code> or <code class="docutils literal"><span class="pre">release.props</span></code>.  I read these files from the
<a class="reference external" href="http://hg.python.org/cpython/tags">CPython Hg web interface</a> for each tagged
release.</p>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Python version</th>
<th class="head">VC++ version</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2.5.6</td>
<td>7.1</td>
</tr>
<tr class="row-odd"><td>2.6.9</td>
<td>9.0</td>
</tr>
<tr class="row-even"><td>2.7.6</td>
<td>9.0</td>
</tr>
<tr class="row-odd"><td>3.2.3</td>
<td>9.0</td>
</tr>
<tr class="row-even"><td>3.3.5</td>
<td>10.0</td>
</tr>
<tr class="row-odd"><td>3.4.0</td>
<td>10.0</td>
</tr>
<tr class="row-even"><td>3.5.0</td>
<td>14.0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installing-free-versions-of-microsoft-visual-c-c">
<h2>Installing free versions of Microsoft Visual C / C++<a class="headerlink" href="#installing-free-versions-of-microsoft-visual-c-c" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pythons-2-7-and-3-2">
<h3>Pythons 2.7 (and 3.2)<a class="headerlink" href="#pythons-2-7-and-3-2" title="Permalink to this headline">¶</a></h3>
<p>If you are compiling for Python 2.7, you should first try the installer at
<a class="reference external" href="http://aka.ms/vcpython27">http://aka.ms/vcpython27</a>.  I installed this for all users from a <code class="docutils literal"><span class="pre">cmd</span></code>
Window opened with &#8220;run as administrator&#8221;, like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msiexec</span> <span class="o">/</span><span class="n">i</span> <span class="n">VCForPython27</span><span class="o">.</span><span class="n">msi</span> <span class="n">ALLUSERS</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>This command line comes from the &#8220;Install instructions&#8221; on the download page.
For me, the installer runs but closes without showing any signs that it has
finished.  The compilers seem to work fine nevertheless.  If this standalone
Python 2.7 compiler set works for you, you should be able to compile both 32
and 64 bit extensions without further configuration.  If not, see
<a class="reference internal" href="#other-options"><span class="std std-ref">Other options for MSVC installation</span></a>.</p>
</div>
<div class="section" id="pythons-3-3-and-3-4">
<h3>Pythons 3.3 and 3.4<a class="headerlink" href="#pythons-3-3-and-3-4" title="Permalink to this headline">¶</a></h3>
<p>For Pythons 3.3 and 3.4 you will need MSVC 2010.</p>
<div class="section" id="compiling-for-64-bit">
<h4>Compiling for 64-bit<a class="headerlink" href="#compiling-for-64-bit" title="Permalink to this headline">¶</a></h4>
<p>For 64-bit compiles, I recommend you get your compilers via the Window 7.1 SDK.
This includes the VS 10 / 2010 command line compilers you need to compile
Python extensions.  I found that I needed to install from the <a class="reference external" href="https://www.microsoft.com/en-us/download/details.aspx?id=8442">offline ISO
files</a>.  As
you will see in the &#8220;Install Instructions&#8221;, choose <code class="docutils literal"><span class="pre">GRMSDKX_EN_DVD.iso</span></code> for
64-bit compiles.</p>
<p>I believe Windows 8, 10 and server 2012 can mount ISO files from explorer.  For
Windows 7 / server 2008 I used <a class="reference external" href="http://www.slysoft.com/en/virtual-clonedrive.html">Virtual clone drive</a> to mount the ISO files.</p>
<p>To run the install, navigate to the folder <code class="docutils literal"><span class="pre">Setup</span></code> on the DVD image, and run
<code class="docutils literal"><span class="pre">SDKSetup.exe</span></code>.  Otherwise you may get an error about .NET components that
cannot be installed.</p>
<p>Finally, for 64-bits, I needed to apply this patch to avoid a distutils
compilation error ending in <code class="docutils literal"><span class="pre">ValueError:</span> <span class="pre">['path']</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;C:\Program Files\Microsoft SDKs\Windows</span><span class="se">\v</span><span class="s2">7.1\Bin\SetEnv.cmd&quot;</span> <span class="o">/</span><span class="n">x64</span> <span class="o">&gt;</span> <span class="s2">&quot;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC</span><span class="se">\b</span><span class="s2">in</span><span class="se">\a</span><span class="s2">md64/vcvars64.bat&quot;</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://stackoverflow.com/questions/32091593/cannot-install-windows-sdk-7-1-on-windows-10">this MSVC 2010 SO post</a>
for details on installing the Windows 7.1 SDK, and <a class="reference external" href="http://stackoverflow.com/questions/26473854/python-pip-has-issues-with-path-for-ms-visual-studio-2010-express-for-64-bit-ins">this SO answer</a>
for specifics on the 64-bit distutils error that can be fixed with the
<code class="docutils literal"><span class="pre">echo</span></code> command above.</p>
</div>
<div class="section" id="compiling-for-32-bit">
<h4>Compiling for 32-bit<a class="headerlink" href="#compiling-for-32-bit" title="Permalink to this headline">¶</a></h4>
<p>Download and install the <a class="reference external" href="https://app.vssps.visualstudio.com/profile/review?download=true&amp;family=VisualStudioCExpress&amp;release=VisualStudio2010">MSVC 2010 express edition</a>.</p>
</div>
</div>
<div class="section" id="python-3-5">
<h3>Python 3.5<a class="headerlink" href="#python-3-5" title="Permalink to this headline">¶</a></h3>
<p>For Python 3.5 32-bit and 64-bit extensions you need MSVC 14 / 2015. <a class="reference external" href="https://www.visualstudio.com/products/visual-studio-community-vs">VS 2015
community edition</a> is free as
in beer.  It&#8217;s a huge 11GB install which took more than an hour on my machine.
Do a custom install, and select the VC++ compiler component (it is not selected
by default).</p>
<p>A better plan might be the <a class="reference external" href="http://landinghub.visualstudio.com/visual-cpp-build-tools">MSVC 2015 command line tools</a>. Python 3.5 does
not detect these tools by default.  See the <a class="reference external" href="https://wiki.python.org/moin/WindowsCompilers">Python Windows compilers wiki
page</a> for instructions to
configure MSVC build tools to work with Python 3.5.</p>
</div>
</div>
<div class="section" id="other-options-for-msvc-installation">
<span id="other-options"></span><h2>Other options for MSVC installation<a class="headerlink" href="#other-options-for-msvc-installation" title="Permalink to this headline">¶</a></h2>
<p>If the VS for Python 2.7 installer doesn&#8217;t work for you, or you can&#8217;t get VS
2010 compilation working for 3.3 / 3.4, see the links below.</p>
<p>In overview, you may be able to find the free Visual Studio express download
that you need on the Microsoft site, but until VS 2015, these do not compile
64-bit extensions by default.   The instructions above give the easiest way to
get 64-bit compiles working, but you can also try the other methods given in
the links below.</p>
</div>
<div class="section" id="some-older-links-on-installing-msvc">
<h2>Some older links on installing MSVC<a class="headerlink" href="#some-older-links-on-installing-msvc" title="Permalink to this headline">¶</a></h2>
<p>Here are some links that were useful at some point:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/cython/cython/wiki/CythonExtensionsOnWindows#using-microsoft-visual-c-compiler-for-python-only-for-python-27x">Cython windows wiki page</a>.
This has more on configuration for 64-bit in particular.</li>
<li><a class="reference external" href="http://www.visualstudio.com/downloads/download-visual-studio-vs">VS downloads</a></li>
<li><a class="reference external" href="http://www.microsoft.com/en-us/download/details.aspx?id=2680">VS 2010 SDK</a></li>
<li><a class="reference external" href="http://msdn.microsoft.com/en-us/library/9yb4317s%28v=vs.100%29.aspx">How to configure VS 10.0 for 64 bit</a></li>
<li><a class="reference external" href="http://go.microsoft.com/?linkid=7729279">VS 2008 download</a></li>
<li>Some <a class="reference external" href="http://www.mathworks.com/matlabcentral/answers/98351-how-can-i-set-up-microsoft-visual-studio-2008-express-edition-for-use-with-matlab-7-7-r2008b-on-64">relevant instructions from a MATLAB user</a>
for getting the VS 2008 SDK set up (the default downloads will refuse to
install onto VS express).</li>
<li><a class="reference external" href="http://msdn.microsoft.com/en-us/library/9yb4317s%28v=vs.90%29.aspx">How to configure VS 9.0 for 64 bit</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Microsoft Visual C with Python</a><ul>
<li><a class="reference internal" href="#visual-studio-compiler-versions">Visual studio compiler versions</a></li>
<li><a class="reference internal" href="#visual-studio-versions-used-to-compile-distributed-python-binaries">Visual Studio versions used to compile distributed Python binaries</a></li>
<li><a class="reference internal" href="#installing-free-versions-of-microsoft-visual-c-c">Installing free versions of Microsoft Visual C / C++</a><ul>
<li><a class="reference internal" href="#pythons-2-7-and-3-2">Pythons 2.7 (and 3.2)</a></li>
<li><a class="reference internal" href="#pythons-3-3-and-3-4">Pythons 3.3 and 3.4</a><ul>
<li><a class="reference internal" href="#compiling-for-64-bit">Compiling for 64-bit</a></li>
<li><a class="reference internal" href="#compiling-for-32-bit">Compiling for 32-bit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-3-5">Python 3.5</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-options-for-msvc-installation">Other options for MSVC installation</a></li>
<li><a class="reference internal" href="#some-older-links-on-installing-msvc">Some older links on installing MSVC</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installing_scripts.html"
                        title="previous chapter">Installing python scripts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="installing_on_debian.html"
                        title="next chapter">Using pip on Debian / Ubuntu</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/python_msvc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="installing_on_debian.html" title="Using pip on Debian / Ubuntu"
             >next</a> |</li>
        <li class="right" >
          <a href="installing_scripts.html" title="Installing python scripts"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="python.html" >Notes and tutorials on Python</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2016 - Matthew Brett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>