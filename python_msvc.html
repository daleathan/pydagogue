<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using Microsoft Visual C with Python &mdash; pydagogue 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/traditional.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pydagogue 0.2 documentation" href="index.html" />
    <link rel="up" title="Notes and tutorials on Python" href="python.html" />
    <link rel="next" title="Notes and tutorials on git" href="git.html" />
    <link rel="prev" title="Installing python scripts" href="installing_scripts.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="git.html" title="Notes and tutorials on git"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installing_scripts.html" title="Installing python scripts"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="python.html" accesskey="U">Notes and tutorials on Python</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-microsoft-visual-c-with-python">
<h1>Using Microsoft Visual C with Python<a class="headerlink" href="#using-microsoft-visual-c-with-python" title="Permalink to this headline">¶</a></h1>
<div class="section" id="visual-studio-compiler-versions">
<h2>Visual studio compiler versions<a class="headerlink" href="#visual-studio-compiler-versions" title="Permalink to this headline">¶</a></h2>
<p>Here is a list of Visual Studio / <a class="reference external" href="http://en.wikipedia.org/wiki/Visual_C%2B%2B">Visual C++</a> version numbers, the value of
the defined <code class="docutils literal"><span class="pre">_MSC_VER</span></code> during compilation, the alternative year-based name,
and the C / C++ runtime library.</p>
<p>For sources on version numbers / <code class="docutils literal"><span class="pre">_MSC_VER</span></code>:</p>
<ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/questions/3592805/detecting-compiler-versions-during-compile-time">a stackoverflow table</a>;</li>
<li>a <a class="reference external" href="http://sourceforge.net/p/predef/wiki/Compilers">sourceforge wiki page on compilers</a>;</li>
<li><a class="reference external" href="http://stackoverflow.com/questions/2676763/what-version-of-visual-studio-is-python-on-my-computer-compiled-with">stackoverflow answer on VC and Python</a>.</li>
</ul>
<p>For VC runtime libraries:</p>
<ul class="simple">
<li>a <a class="reference external" href="https://support.microsoft.com/en-us/kb/154753">list of VS versions / CRTS</a>;</li>
<li>a <a class="reference external" href="http://yuhongbao.blogspot.com/2014/10/the-history-of-ms-c-runtime-dll.html">history of the MS CRTS</a>;</li>
<li>the MS <a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh(v=vs.100).aspx">C runtime library pages</a>;</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="28%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">VC++ version</th>
<th class="head">_MSC_VER</th>
<th class="head">Alternative name</th>
<th class="head">C runtime</th>
<th class="head">C++ runtime</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1.0</td>
<td>800</td>
<td>&nbsp;</td>
<td>MSVCRT10.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>2.0</td>
<td>900</td>
<td>&nbsp;</td>
<td>MSVCRT20.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>4.0</td>
<td>1000</td>
<td>&nbsp;</td>
<td>MSVCRT40.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>4.2</td>
<td>1020</td>
<td>&nbsp;</td>
<td>MSVCRT.DLL</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>5.0</td>
<td>1100</td>
<td>Visual Studio 97</td>
<td>MSVCRT.DLL</td>
<td>MSVCP50.DLL</td>
</tr>
<tr class="row-odd"><td>6.0</td>
<td>1200</td>
<td>&nbsp;</td>
<td>MSVCRT.DLL</td>
<td>MSVCP60.DLL</td>
</tr>
<tr class="row-even"><td>7.0</td>
<td>1300</td>
<td>Visual Studio 2002</td>
<td>MSVCR70.DLL</td>
<td>MSVCP70.DLL</td>
</tr>
<tr class="row-odd"><td>7.1</td>
<td>1310</td>
<td>Visual Studio 2003</td>
<td>MSVCR71.DLL</td>
<td>MSVCP71.DLL</td>
</tr>
<tr class="row-even"><td>8.0</td>
<td>1400</td>
<td>Visual Studio 2005</td>
<td>MSVCR80.DLL</td>
<td>MSVCP80.DLL</td>
</tr>
<tr class="row-odd"><td>9.0</td>
<td>1500</td>
<td>Visual Studio 2008</td>
<td>MSVCR90.DLL</td>
<td>MSVCP90.DLL</td>
</tr>
<tr class="row-even"><td>10.0</td>
<td>1600</td>
<td>Visual Studio 2010</td>
<td>MSVCR100.DLL</td>
<td>MSVCP100.DLL</td>
</tr>
<tr class="row-odd"><td>11.0</td>
<td>1700</td>
<td>Visual Studio 2012</td>
<td>MSVCR110.DLL</td>
<td>MSVCP110.DLL</td>
</tr>
<tr class="row-even"><td>12.0</td>
<td>1800</td>
<td>Visual Studio 2013</td>
<td>MSVCR120.DLL</td>
<td>MSVCP120.DLL</td>
</tr>
<tr class="row-odd"><td>14.0</td>
<td>1900</td>
<td>Visual Studio 2015</td>
<td>See notes</td>
<td>See notes</td>
</tr>
</tbody>
</table>
<p>For a discussion of the generic <code class="docutils literal"><span class="pre">MSVCRT.DLL</span></code> compared to the DLLs specific
to the VC version, see <a class="reference external" href="https://kobyk.wordpress.com/2007/07/20/dynamically-linking-with-msvcrtdll-using-visual-c-2005">this blog post</a>.
See also <a class="reference external" href="http://sourceforge.net/p/mingw-w64/wiki2/The%20case%20against%20msvcrt.dll">these comments on using MSVCRT.DLL from Mingw-w64</a>.</p>
<p>For 2015, MS split the C runtime into two component libraries.  See:</p>
<ul class="simple">
<li>blog post on the <a class="reference external" href="http://blogs.msdn.com/b/vcblog/archive/2015/03/03/introducing-the-universal-crt.aspx">the universal CRT</a></li>
<li>Steve Dower&#8217;s first blog post: <a class="reference external" href="http://stevedower.id.au/blog/building-for-python-3-5">Python 3.5 extensions part 1</a>;</li>
<li>Steve&#8217;s second blog post: <a class="reference external" href="http://stevedower.id.au/blog/building-for-python-3-5-part-two">Python 3.5 extensions part 2</a>;</li>
</ul>
<p>The CRT components are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ucrtbase.dl</span></code>: &#8220;The Universal CRT (UCRT) contains the functions and
globals exported by the standard C99 CRT library. The UCRT is now a Windows
component, and ships as part of Windows 10.&#8221; (see <a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>).</li>
<li><code class="docutils literal"><span class="pre">vcruntime140.dll</span></code> : &#8220;The vcruntime library contains Visual C++ CRT
implementation-specific code, such as exception handling and debugging
support, runtime checks and type information, implementation details and
certain extended library functions. This library is specific to the version
of the compiler used.&#8221; (<a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>);</li>
</ul>
<p>The C++ runtime for VS2015 is <code class="docutils literal"><span class="pre">MSVCP140.dll</span></code> (<a class="reference external" href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">CRT 2015</a>).</p>
</div>
<div class="section" id="visual-studio-versions-used-to-compile-distributed-python-binaries">
<h2>Visual Studio versions used to compile distributed Python binaries<a class="headerlink" href="#visual-studio-versions-used-to-compile-distributed-python-binaries" title="Permalink to this headline">¶</a></h2>
<p>See:
<a class="reference external" href="http://stackoverflow.com/questions/12028762/what-version-of-visual-studio-and-or-mingw-do-i-need-to-build-extension-modules">http://stackoverflow.com/questions/12028762/what-version-of-visual-studio-and-or-mingw-do-i-need-to-build-extension-modules</a></p>
<p>and: <a class="reference external" href="http://stackoverflow.com/questions/9047072/windows-python-version-and-vc-redistributable-version">http://stackoverflow.com/questions/9047072/windows-python-version-and-vc-redistributable-version</a></p>
<p>The version of Visual Studio is described in <code class="docutils literal"><span class="pre">readme.txt</span></code> in the <code class="docutils literal"><span class="pre">PCBuild</span></code>
folder of the source distribution.  The full Visual C++ version number is in
either <code class="docutils literal"><span class="pre">release.vsprops</span></code> or <code class="docutils literal"><span class="pre">release.props</span></code>.  I read these files from the
<a class="reference external" href="http://hg.python.org/cpython/tags">CPython Hg web interface</a> for each tagged
release.</p>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Python version</th>
<th class="head">VC++ version</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2.5.6</td>
<td>7.1</td>
</tr>
<tr class="row-odd"><td>2.6.9</td>
<td>9.0</td>
</tr>
<tr class="row-even"><td>2.7.6</td>
<td>9.0</td>
</tr>
<tr class="row-odd"><td>3.2.3</td>
<td>9.0</td>
</tr>
<tr class="row-even"><td>3.3.5</td>
<td>10.0</td>
</tr>
<tr class="row-odd"><td>3.4.0</td>
<td>10.0</td>
</tr>
<tr class="row-even"><td>3.5.0</td>
<td>14.0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installing-free-versions-of-microsoft-visual-c-c">
<h2>Installing free versions of Microsoft Visual C / C++<a class="headerlink" href="#installing-free-versions-of-microsoft-visual-c-c" title="Permalink to this headline">¶</a></h2>
<p>If you are compiling for Python 2.7, you should first try the installer at
<a class="reference external" href="http://aka.ms/vcpython27">http://aka.ms/vcpython27</a>. If it works for you, it should compile both 32 and
64 bit extensions. See the <a class="reference external" href="https://github.com/cython/cython/wiki/CythonExtensionsOnWindows#using-microsoft-visual-c-compiler-for-python-only-for-python-27x">Cython windows wiki page</a>
for more detail of configuration for 64-bit in particular.</p>
<p>The <a class="reference external" href="https://www.visualstudio.com/products/visual-studio-community-vs">VS 2015 community edition</a> is free
as in beer.  It&#8217;s a hefty 11GB install.  This will build Python 3.5
extensions, 32 or 64 bit.</p>
<p>If you are not compiling for 3.5, and the custom installer above doesn&#8217;t work,
and you are only compiling for 32 bit, you can use the Visual Studio Express
package (2008==9.0 for Python 2.7, 2010==10.0 for Python 3.4). See the links
below.</p>
<p>For 64 bit compilation in this situation, you&#8217;ll need the matching SDK, and
you don&#8217;t need Visual Studio Express - see the <a class="reference external" href="https://github.com/cython/cython/wiki/CythonExtensionsOnWindows">Cython windows page</a> again.</p>
<p>Here are some links that were useful at some point:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.visualstudio.com/downloads/download-visual-studio-vs">VS downloads</a></li>
<li><a class="reference external" href="http://www.microsoft.com/en-us/download/details.aspx?id=2680">VS 2010 SDK</a></li>
<li><a class="reference external" href="http://msdn.microsoft.com/en-us/library/9yb4317s%28v=vs.100%29.aspx">How to configure VS 10.0 for 64 bit</a></li>
<li><a class="reference external" href="http://go.microsoft.com/?linkid=7729279">VS 2008 download</a></li>
<li>Some <a class="reference external" href="http://www.mathworks.com/matlabcentral/answers/98351-how-can-i-set-up-microsoft-visual-studio-2008-express-edition-for-use-with-matlab-7-7-r2008b-on-64">relevant instructions from a MATLAB user</a>
for getting the VS 2008 SDK set up (the default downloads will refuse to install onto the VS express).</li>
<li><a class="reference external" href="http://msdn.microsoft.com/en-us/library/9yb4317s%28v=vs.90%29.aspx">How to configure VS 9.0 for 64 bit</a></li>
</ul>
<p>It&#8217;s useful to be able to mount the downloaded ISO images directly for
installation.  I had good success with <a class="reference external" href="http://www.slysoft.com/en/virtual-clonedrive.html">Virtual clone drive</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Microsoft Visual C with Python</a><ul>
<li><a class="reference internal" href="#visual-studio-compiler-versions">Visual studio compiler versions</a></li>
<li><a class="reference internal" href="#visual-studio-versions-used-to-compile-distributed-python-binaries">Visual Studio versions used to compile distributed Python binaries</a></li>
<li><a class="reference internal" href="#installing-free-versions-of-microsoft-visual-c-c">Installing free versions of Microsoft Visual C / C++</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installing_scripts.html"
                        title="previous chapter">Installing python scripts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="git.html"
                        title="next chapter">Notes and tutorials on git</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/python_msvc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="git.html" title="Notes and tutorials on git"
             >next</a> |</li>
        <li class="right" >
          <a href="installing_scripts.html" title="Installing python scripts"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="python.html" >Notes and tutorials on Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2009, 2010 - Matthew Brett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>