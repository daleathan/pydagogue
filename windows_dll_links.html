<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Windows DLLs - information &mdash; pydagogue 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/traditional.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pydagogue 0.2 documentation" href="index.html" />
    <link rel="up" title="General computing" href="computing.html" />
    <link rel="prev" title="Bare metal WAF" href="bare_metal_waf.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="bare_metal_waf.html" title="Bare metal WAF"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li><a href="computing.html" accesskey="U">General computing</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="windows-dlls-information">
<h1>Windows DLLs - information<a class="headerlink" href="#windows-dlls-information" title="Permalink to this headline">Â¶</a></h1>
<p>Exploring where to put Windows DLLs for load-time or run-time discovery.</p>
<ul>
<li><p class="first">Commentary <a class="reference external" href="https://ghc.haskell.org/trac/ghc/wiki/SharedLibraries/Management#OnWindows">shared libraries in windows</a>
on the Glasgow Haskell Compiler wiki.  See discussion of side-by-side
assemblies.</p>
</li>
<li><p class="first">Microsoft documentation on <a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms686203.aspx">SetDllDirectory</a>. From those docs:</p>
<blockquote>
<div><p>The SetDllDirectory function affects all subsequent calls to the
LoadLibrary and LoadLibraryEx functions. It also effectively disables safe
DLL search mode while the specified directory is in the search path.</p>
</div></blockquote>
<p>So this call might have unexpected conseequences for unrelated DLL loading
afterwards.</p>
</li>
<li><p class="first">Microsoft documentation on the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms684179.aspx">LoadLibraryEx</a>
call. On <tt class="docutils literal"><span class="pre">SetDllDirectory</span></tt>:</p>
<blockquote>
<div><p>However, be aware that using SetDllDirectory effectively disables safe DLL
search mode while the specified directory is in the search path and it is
not thread safe.  If possible, it is best to use AddDllDirectory to modify a
default process search path.</p>
</div></blockquote>
</li>
<li><p class="first">Microsoft documentation on <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/hh310513.aspx">AddDllDirectory</a></p>
</li>
<li><p class="first">Microsoft documentation on the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms682586.aspx#standard_search_order_for_desktop_applications">Standard DLL search order</a>
for desktop applications.</p>
</li>
<li><p class="first">The <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586.aspx#alternate_search_order_for_desktop_applications">alternate DLL search order</a>
that is triggered by calling DLL loading with the flag
<cite>LOAD_WITH_ALTERED_SEARCH_PATH</cite>.</p>
</li>
<li><p class="first">Python loads extensions with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hDLL</span> <span class="o">=</span> <span class="n">LoadLibraryEx</span><span class="p">(</span><span class="n">pathname</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span>
                     <span class="n">LOAD_WITH_ALTERED_SEARCH_PATH</span><span class="p">);</span>
</pre></div>
</div>
<p>See: <a class="reference external" href="http://hg.python.org/cpython/file/3a1db0d2747e/Python/dynload_win.c#l195">dynload_win.c line 195</a>
in Python 2.7 - for example.</p>
</li>
<li><p class="first">Microsoft documentation on <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff951638.aspx">Private side by side assemblies</a></p>
</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="bare_metal_waf.html"
                        title="previous chapter">Bare metal WAF</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/windows_dll_links.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="bare_metal_waf.html" title="Bare metal WAF"
             >previous</a> |</li>
        <li><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li><a href="computing.html" >General computing</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, 2010 - Matthew Brett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>