<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developing on windows &mdash; pydagogue 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pydagogue 0.2 documentation" href="index.html" />
    <link rel="next" title="Developing on mac" href="develop_mac.html" />
    <link rel="prev" title="Python and unicode" href="python_unicode.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="develop_mac.html" title="Developing on mac"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="python_unicode.html" title="Python and unicode"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="developing-on-windows">
<h1>Developing on windows<a class="headerlink" href="#developing-on-windows" title="Permalink to this headline">¶</a></h1>
<p>This is a sketch of the steps that I (MB) went through setting up a
semi-standard development environment for <a class="reference external" href="http://www.python.org">python</a> packaging on windows.</p>
<div class="section" id="my-system-s">
<h2>My system(s)<a class="headerlink" href="#my-system-s" title="Permalink to this headline">¶</a></h2>
<p>I&#8217;ve got several Windows 7 instances running mainly as buildbot machines, a
Windows 8 machine kindly donated by Chris Holdgraf of the UC Berkeley Knight
lab, and some virtual machines, also running Windows 7.  I used to have some XP
machines, but UC Berkeley doesn&#8217;t allow them on the network any more.</p>
</div>
<div class="section" id="basic-setup">
<h2>Basic setup<a class="headerlink" href="#basic-setup" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Shell: in the old days, we had to use the awful Windows <tt class="docutils literal"><span class="pre">cmd</span></tt> shell. It&#8217;s still
useful sometimes, but the newer <a class="reference external" href="http://www.microsoft.com/powershell">powershell</a> is vastly better.  It comes
installed with Windows 7 and later.  If you are using Vista or XP (really?),
you will have to install it (see links from <a class="reference external" href="http://www.microsoft.com/powershell">powershell</a> page.  Windows 7).
Unlike <tt class="docutils literal"><span class="pre">cmd</span></tt>, Powershell has good command and filename completion, <tt class="docutils literal"><span class="pre">ls</span></tt>
for directory listing, a less idiosyncratic <tt class="docutils literal"><span class="pre">cd</span></tt>, and a scripting language
that is less painful than <tt class="docutils literal"><span class="pre">cmd</span></tt> bat scripting. I believe I&#8217;ve used version 1
and version 2.  <tt class="docutils literal"><span class="pre">\`Host.version</span></tt> was <tt class="docutils literal"><span class="pre">1</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">0</span></tt> on my old XP installation.
Don&#8217;t forget to enable <a class="reference external" href="http://support.microsoft.com/kb/282301">quickedit mode</a> for much nicer right click copy and
paste.</li>
<li>Install <a class="reference external" href="http://code.google.com/p/msysgit">msysgit</a>. In the installation, set <tt class="docutils literal"><span class="pre">git</span></tt> to be on the command path,
but not the git bash utilities.  I set the repo to have LF endings, but the
checked out files to have system endings. You&#8217;ll see this setting offered in
the installation GUI - it sets <tt class="docutils literal"><span class="pre">core.autocrlf=input</span></tt> in your global git
config.</li>
</ul>
</div>
<div class="section" id="ssh-setup">
<h2>SSH setup<a class="headerlink" href="#ssh-setup" title="Permalink to this headline">¶</a></h2>
<p>msysgit has ssh, but for various reasons I wanted to be able to use powershell
with git.  In order to do this I need to get git SSH authentication working via
the windows tools:</p>
<ul>
<li><p class="first">Install <a class="reference external" href="http://www.chiark.greenend.org.uk/~sgtatham/putty">putty</a>.  Well, in fact, install all the putty utilities via the
windows installer - including <em>plink</em> and <em>pageant</em>.  These are utilities we
need for handling ssh authentication for git and other tools.</p>
</li>
<li><p class="first">You might consider putting the Putty directory on the path. Something like:</p>
<div class="highlight-python"><div class="highlight"><pre>$my_path = [Environment]::GetEnvironmentVariable(&quot;PATH&quot;,&quot;User&quot;)
$my_path += &quot;;C:\Program files (x86)\Putty&quot; # (x86) on my windows 7 system
[Environment]::SetEnvironmentVariable(&quot;PATH&quot;, $my_path, &quot;User&quot;)
</pre></div>
</div>
</li>
<li><p class="first">I have ssh keys I use on unix and mac.  I got the necessary ssh keys via sftp
(installed by Putty installer). These went into <tt class="docutils literal"><span class="pre">$HOME/.ssh</span></tt>. I then ran
<em>PUTTYgen</em> (installed by the Putty installer) to import the Unix ssh key into
putty <tt class="docutils literal"><span class="pre">.ppk</span></tt> format.  Save <tt class="docutils literal"><span class="pre">.ppk</span></tt> in <tt class="docutils literal"><span class="pre">$HOME/.ssh</span></tt>.</p>
</li>
<li><p class="first">Start <em>pageant</em> (installed by putty installer).  Add <tt class="docutils literal"><span class="pre">.ppk</span></tt> key file.</p>
</li>
<li><p class="first">If you&#8217;ve got the putty utilities on the path, check you can get authenticated
e.g. into github with <tt class="docutils literal"><span class="pre">plink</span> <span class="pre">git&#64;github.com</span></tt>.  If you don&#8217;t have putty etc
on the path, you&#8217;ll need the full path to plink, as in: <tt class="docutils literal"><span class="pre">&quot;c:\Program</span> <span class="pre">files</span>
<span class="pre">(x86)\Putty\plink</span> <span class="pre">git&#64;github.com&quot;</span></tt>.</p>
</li>
<li><p class="first">Set a couple of environment variables from powershell - see
<a class="reference external" href="http://technet.microsoft.com/en-us/library/ff730964.aspx">powershell environment variables</a>.  First set <tt class="docutils literal"><span class="pre">$GIT_SSH</span></tt> to pick up
<em>plink</em> as the ssh executable:</p>
<div class="highlight-python"><div class="highlight"><pre>[Environment]::SetEnvironmentVariable(&quot;GIT_SSH&quot;, &quot;C:\Program files\Putty\plink.exe&quot;, &quot;User&quot;)
</pre></div>
</div>
<p>Next we make sure that <tt class="docutils literal"><span class="pre">$HOME</span></tt> is set for safety.  For example, <a class="reference external" href="http://pypi.python.org/pypi/setuptools">setuptools</a>
appears to need it set correctly - see the <a class="reference external" href="http://packages.python.org/an_example_pypi_project/setuptools.html#intermezzo-pypirc-file-and-gpg">example pypi</a> page for the
assertion at least:</p>
<div class="highlight-python"><div class="highlight"><pre>[Environment]::SetEnvironmentVariable(&quot;HOME&quot;, $env:USERPROFILE, &quot;User&quot;)
</pre></div>
</div>
<p>Restart powershell after doing this to pick up the <tt class="docutils literal"><span class="pre">GIT_SSH</span></tt> environment
variable in particular.  We should now be able to do something like <tt class="docutils literal"><span class="pre">git</span>
<span class="pre">clone</span> <span class="pre">git&#64;github.com:my-name/my-repo.git</span></tt> without being asked our password
(pageant handles this).  The first time you use this combination with a
particular host you may get an error like this:</p>
<div class="highlight-python"><div class="highlight"><pre>The server&#39;s host key is not cached in the registry. You
have no guarantee that the server is the computer you
think it is.
</pre></div>
</div>
<p>If so, run <em>plink</em> manually to cache the key:</p>
<div class="highlight-python"><div class="highlight"><pre>&amp; &#39;C:\Program Files (x86)\PuTTY\plink.exe&#39; git@github.com
</pre></div>
</div>
<p>and press <tt class="docutils literal"><span class="pre">y</span></tt> when asked.</p>
</li>
<li><p class="first">I run pageant at startup.  I first set up a desktop shortcut with the
following command:</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;C:\Program Files (x86)\PuTTY\pageant.exe&quot; c:\Users\mb312\.ssh\id_dsa.ppk
</pre></div>
</div>
<p>I move this shortcut into my startup folder to start at login.  On windows 7
my startup folder is:</p>
<div class="highlight-python"><div class="highlight"><pre>C:\Users\mb312\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">mb312</span></tt> is my username.</p>
</li>
<li><p class="first">For using ssh inside the msysgit bash shell, I like to add the keychain-like
script, by including this in my <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> file:</p>
<div class="highlight-python"><div class="highlight"><pre># Source personal definitions
if [ -f &quot;$HOME/.bash_keychain_lite&quot; ]; then
    . &quot;$HOME/.bash_keychain_lite&quot;
fi
</pre></div>
</div>
<p>where the <tt class="docutils literal"><span class="pre">.bash_keychain_lite</span></tt> file arises from the <tt class="docutils literal"><span class="pre">make.py</span> <span class="pre">dotfiles</span></tt>
command above.</p>
</li>
</ul>
<div class="section" id="miscellaneous">
<h3>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">I got used to the mac keyboard way of using the command key for things like
making new tabs in the browser (command-t), copy, paste (command-c, command-v)
and so on. I can&#8217;t replicate all of this on windows, but as a first pass, I
use an <a class="reference external" href="http://ahkscript.org/">autohotkey</a> script.  Putting this <tt class="docutils literal"><span class="pre">remap.ahk</span></tt> script file into my
Windows start menu startup folder caused it to be loaded at login:</p>
<div class="highlight-python"><div class="highlight"><pre>; From: http://superuser.com/questions/241889/macbook-pro-windows-7-remap-cmd-key-to-ctrl-except-cmdtab-to-alttab
; See also : http://www.autohotkey.com/docs/Hotkeys.htm
; # usually means Windows key.
#SingleInstance force ; but sometimes # introduces a command
#r::Send ^r ;reload
#z::Send ^z ; undo
#y::Send ^y ; redo
#f::Send ^f ; find inside apps
#g::Send ^g ; repeat find inside apps
#c::Send ^c ; copy
#x::Send ^x ; cut
#v::Send ^v ; paste
#a::Send ^a ; select all
#t::Send ^t ; new tab in browser (IE, Safari, Firefox, etc)
#s::Send ^s ; save inside apps
LWin &amp; Tab::AltTab ; the motherlode, alt-tab!

#Up::Send {PgUp} ; PgUp
#Down::Send {PgDn} ; PgDown
#Left::Send {home} ; Home
#Right::Send {end} ; End
#LButton::^LButton
</pre></div>
</div>
</li>
<li><p class="first">I depend heavily on knowing which branch I am on when using git.  This is the
what the <tt class="docutils literal"><span class="pre">git-completion</span></tt> bash routines do; <a class="reference external" href="https://github.com/dahlbyk/posh-git">posh-git</a> does the equivalent
for powershell.</p>
</li>
</ul>
</div>
<div class="section" id="other-programs">
<h3>Other programs<a class="headerlink" href="#other-programs" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Install editor.  I use <a class="reference external" href="http://www.vim.org">vim</a>.  With a 64 bit python (below), I needed a <a class="reference external" href="http://code.google.com/p/vim-win3264/wiki/Win64Binaries">64 bit
vim</a></p>
</li>
<li><p class="first">Install <a class="reference external" href="http://www.python.org">python</a> - the current version.  I need this for the scripts installing
the personal configuration below.  For the convenience of using python at the
command line you could do something like:</p>
<div class="highlight-python"><div class="highlight"><pre>$my_path = [Environment]::GetEnvironmentVariable(&quot;PATH&quot;,&quot;User&quot;)
$my_path += &quot;;C:\Python27;C:\Python27\Scripts&quot;
[Environment]::SetEnvironmentVariable(&quot;PATH&quot;, $my_path, &quot;User&quot;)
</pre></div>
</div>
</li>
<li><p class="first">Set up personal configuration.  For me this is:</p>
<div class="highlight-python"><div class="highlight"><pre>cd c:\
mkdir code
cd code
mkdir dev_trees
cd dev_trees
git clone git@github.com:matthew-brett/myconfig.git
git clone git@github.com:matthew-brett/myvim.git
cd myconfig
python make.py dotfiles
cd ..\myvim
python make.py vimfiles
</pre></div>
</div>
</li>
<li><p class="first">I am trying out <a class="reference external" href="https://bitbucket.org/guillermooo/virtualenvwrapper-powershell">virtualenvwrapper-powershell</a> . Install with the standard
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></tt>.  You then need <tt class="docutils literal"><span class="pre">import-module</span>
<span class="pre">virtualenvwrapper</span></tt> from the powershell prompt.  Maybe it goes better in a
<a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb613488%28v=vs.85%29.aspx">powershell profile</a>.</p>
</li>
<li><p class="first">As for any other environment, the <a class="reference external" href="https://github.com/flavioamieiro/nose-ipdb">nose-ipdb</a> ipython debugger for <a class="reference external" href="http://readthedocs.org/docs/nose/en/latest">nose</a> makes
debugging easier for nose tests.  Easiest route is <tt class="docutils literal"><span class="pre">easy_install</span>
<span class="pre">ipdbplugin</span></tt>.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="windows-compiler-and-build-tools">
<span id="win-compile-tools"></span><h2>Windows compiler and build tools<a class="headerlink" href="#windows-compiler-and-build-tools" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Download and install the <a class="reference external" href="http://www.mingw.org/wiki/Getting_Started">mingw</a> windows compiler.  I used the
<tt class="docutils literal"><span class="pre">mingw-get-inst</span></tt> automated installation route.  Select the options giving
you c++, fortran, and the msys build environment.  I didn&#8217;t directly add these
to the path, but made a script <tt class="docutils literal"><span class="pre">c:\Mingw\mingwvars.ps1</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre># convenience script to add mingw to path
echo &quot;Adding mingw to PATH...&quot;
$mingw = [System.IO.Path]::GetDirectoryName($MyInvocation.MyCommand.Definition)
$env:path = &quot;$mingw\bin;$mingw\msys\1.0\bin;$env:path&quot;
</pre></div>
</div>
<p>Then in powershell - <tt class="docutils literal"><span class="pre">.</span> <span class="pre">c:\Mingw\mingwvars.ps1</span></tt> to add the msys and
mingw tools to the path.</p>
</li>
<li><p class="first">Using mingw, you might get this kind of error:</p>
<div class="highlight-python"><div class="highlight"><pre>error: Setup script exited with error: Unable to find vcvarsall.bat
</pre></div>
</div>
<p>Of course you&#8217;ve already tried the standard solution to this, of the form:</p>
<div class="highlight-python"><div class="highlight"><pre>python setup.py build --compiler=mingw32
</pre></div>
</div>
<p>If that doesn&#8217;t work, you might have hit a <a class="reference external" href="http://bugs.python.org/issue2698">mingw distutils bug</a>.  One
suggested fix is to make a <tt class="docutils literal"><span class="pre">distutils.cfg</span></tt> file in your Python distutils
directory (e.g.  <tt class="docutils literal"><span class="pre">C:\Python26\Lib\distutils</span></tt>) with the following content:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">build</span><span class="p">]</span>
<span class="n">compiler</span><span class="o">=</span><span class="n">mingw32</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="swig">
<h2>SWIG<a class="headerlink" href="#swig" title="Permalink to this headline">¶</a></h2>
<p>Download the swig version for windows, <tt class="docutils literal"><span class="pre">swigwin</span></tt>, from <a class="reference external" href="http://www.swig.org/download.html">swig downloads</a>,
unpack into, say, <tt class="docutils literal"><span class="pre">C:\</span></tt>, then:</p>
<div class="highlight-python"><div class="highlight"><pre>$my_path = [Environment]::GetEnvironmentVariable(&quot;PATH&quot;,&quot;User&quot;)
$my_path += &quot;;C:\swigwin-2.0.10&quot;
[Environment]::SetEnvironmentVariable(&quot;PATH&quot;, $my_path, &quot;User&quot;)
[Environment]::SetEnvironmentVariable(&quot;PYTHON_INCLUDE&quot;, &quot;C:\Python27\include&quot;, &quot;User&quot;)
[Environment]::SetEnvironmentVariable(&quot;PYTHON_LIB&quot;, &quot;C:\Python27\libs\python27.lib&quot;, &quot;User&quot;)
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developing on windows</a><ul>
<li><a class="reference internal" href="#my-system-s">My system(s)</a></li>
<li><a class="reference internal" href="#basic-setup">Basic setup</a></li>
<li><a class="reference internal" href="#ssh-setup">SSH setup</a><ul>
<li><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
<li><a class="reference internal" href="#other-programs">Other programs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows-compiler-and-build-tools">Windows compiler and build tools</a></li>
<li><a class="reference internal" href="#swig">SWIG</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="python_unicode.html"
                        title="previous chapter">Python and unicode</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="develop_mac.html"
                        title="next chapter">Developing on mac</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/develop_windows.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="develop_mac.html" title="Developing on mac"
             >next</a> |</li>
        <li class="right" >
          <a href="python_unicode.html" title="Python and unicode"
             >previous</a> |</li>
        <li><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, 2010 - Matthew Brett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>